// src/layouts/DashboardLayout.tsx
import { Outlet } from 'react-router-dom';
import { useState } from 'react';
import { DashboardNavbar } from '../components/DashboardNavbar';
import { DashboardFooter } from '../components/DashboardFooter';
import { MessageCircle, X, Globe } from 'lucide-react';

// Define the type for our language codes
type Language = 'en' | 'hi' | 'mr' | 'pa' | 'bn' | 'ta';

export function DashboardLayout() {
  const [isChatOpen, setIsChatOpen] = useState(false);
  const [language, setLanguage] = useState<Language>('en');
  const [messages, setMessages] = useState<{ sender: string; text: string }[]>([]);
  const [input, setInput] = useState('');

  // --- Expanded Translation Map ---
  const translations = {
    en: {
      greeting: 'Hi there! Iâ€™m your Kisan Saathi assistant.',
      help: 'You can ask me about crop plans, irrigation, disease control, fertilizers, and more!',
      crop: 'ðŸŒ¾ Based on your region, Wheat and Mustard are great options for this season!',
      irrigation: 'ðŸ’§ For wheat, follow 4 irrigation cycles at tillering, jointing, flowering, and dough stages.',
      disease: 'ðŸ¦  Possible disease: Leaf rust. Cure with Mancozeb spray (0.25%) every 10 days.',
      fertilizer: 'ðŸŒ¿ Recommended fertilizer: Urea (120kg/ha) + DAP (60kg/ha) split in 3 doses.',
      community: 'ðŸ‘¥ You can join your nearby farmer community group for market updates and training sessions.',
      training: 'ðŸ“˜ Upcoming training: â€œAdvanced Organic Farmingâ€ on Nov 5th at your nearest KVK center.',
      default: 'ðŸ¤– Iâ€™m not sure about that, but I can help with crops, irrigation, fertilizer, or disease info!',
      hello: 'Hey there! How can I help you today? ðŸ˜Š',
      placeholder: 'Type your message...',
      send: 'Send',
      assistantName: 'Kisan Saathi Assistant',
    },
    hi: {
      greeting: 'ðŸ‘‹ à¤¨à¤®à¤¸à¥à¤¤à¥‡! à¤®à¥ˆà¤‚ à¤†à¤ªà¤•à¤¾ à¤•à¤¿à¤¸à¤¾à¤¨ à¤¸à¤¾à¤¥à¥€ à¤¸à¤¹à¤¾à¤¯à¤• à¤¹à¥‚à¤à¥¤',
      help: 'à¤†à¤ª à¤®à¥à¤à¤¸à¥‡ à¤«à¤¸à¤² à¤¯à¥‹à¤œà¤¨à¤¾à¤“à¤‚, à¤¸à¤¿à¤‚à¤šà¤¾à¤ˆ, à¤°à¥‹à¤— à¤¨à¤¿à¤¯à¤‚à¤¤à¥à¤°à¤£, à¤‰à¤°à¥à¤µà¤°à¤• à¤”à¤° à¤…à¤¨à¥à¤¯ à¤µà¤¿à¤·à¤¯à¥‹à¤‚ à¤ªà¤° à¤ªà¥‚à¤› à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚!',
      crop: 'ðŸŒ¾ à¤†à¤ªà¤•à¥‡ à¤•à¥à¤·à¥‡à¤¤à¥à¤° à¤•à¥‡ à¤…à¤¨à¥à¤¸à¤¾à¤°, à¤‡à¤¸ à¤®à¥Œà¤¸à¤® à¤•à¥‡ à¤²à¤¿à¤ à¤—à¥‡à¤¹à¥‚à¤ à¤”à¤° à¤¸à¤°à¤¸à¥‹à¤‚ à¤¸à¤¬à¤¸à¥‡ à¤…à¤šà¥à¤›à¥‡ à¤µà¤¿à¤•à¤²à¥à¤ª à¤¹à¥ˆà¤‚!',
      irrigation: 'ðŸ’§ à¤—à¥‡à¤¹à¥‚à¤ à¤•à¥‡ à¤²à¤¿à¤ 4 à¤¸à¤¿à¤‚à¤šà¤¾à¤ˆ à¤šà¤•à¥à¤° à¤•à¤°à¥‡à¤‚ â€“ à¤Ÿà¤¿à¤²à¤°à¤¿à¤‚à¤—, à¤œà¥‰à¤‡à¤¨à¥à¤Ÿà¤¿à¤‚à¤—, à¤«à¥‚à¤² à¤†à¤¨à¥‡ à¤”à¤° à¤†à¤Ÿà¥‡ à¤•à¥‡ à¤šà¤°à¤£ à¤®à¥‡à¤‚à¥¤',
      disease: 'ðŸ¦  à¤¸à¤‚à¤­à¤¾à¤µà¤¿à¤¤ à¤°à¥‹à¤—: à¤²à¥€à¤« à¤°à¤¸à¥à¤Ÿà¥¤ à¤‡à¤²à¤¾à¤œ: à¤®à¥ˆà¤‚à¤•à¥‹à¤œà¤¼à¥‡à¤¬ (0.25%) à¤•à¤¾ à¤›à¤¿à¤¡à¤¼à¤•à¤¾à¤µ à¤¹à¤° 10 à¤¦à¤¿à¤¨ à¤®à¥‡à¤‚ à¤•à¤°à¥‡à¤‚à¥¤',
      fertilizer: 'ðŸŒ¿ à¤…à¤¨à¥à¤¶à¤‚à¤¸à¤¿à¤¤ à¤‰à¤°à¥à¤µà¤°à¤•: à¤¯à¥‚à¤°à¤¿à¤¯à¤¾ (120 à¤•à¤¿à¤—à¥à¤°à¤¾/à¤¹à¥‡à¤•à¥à¤Ÿà¥‡à¤¯à¤°) + à¤¡à¥€à¤à¤ªà¥€ (60 à¤•à¤¿à¤—à¥à¤°à¤¾/à¤¹à¥‡à¤•à¥à¤Ÿà¥‡à¤¯à¤°) à¤¤à¥€à¤¨ à¤­à¤¾à¤—à¥‹à¤‚ à¤®à¥‡à¤‚à¥¤',
      community: 'ðŸ‘¥ à¤†à¤ª à¤ªà¤¾à¤¸ à¤•à¥‡ à¤•à¤¿à¤¸à¤¾à¤¨ à¤¸à¤®à¥à¤¦à¤¾à¤¯ à¤¸à¤®à¥‚à¤¹ à¤¸à¥‡ à¤œà¥à¤¡à¤¼ à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚ à¤¬à¤¾à¤œà¤¾à¤° à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤”à¤° à¤ªà¥à¤°à¤¶à¤¿à¤•à¥à¤·à¤£ à¤•à¥‡ à¤²à¤¿à¤à¥¤',
      training: 'ðŸ“˜ à¤†à¤—à¤¾à¤®à¥€ à¤ªà¥à¤°à¤¶à¤¿à¤•à¥à¤·à¤£: "à¤à¤¡à¤µà¤¾à¤‚à¤¸à¥à¤¡ à¤‘à¤°à¥à¤—à¥‡à¤¨à¤¿à¤• à¤«à¤¾à¤°à¥à¤®à¤¿à¤‚à¤—" 5 à¤¨à¤µà¤‚à¤¬à¤° à¤•à¥‹ à¤¨à¤¿à¤•à¤Ÿà¤¤à¤® à¤•à¥‡à¤µà¥€à¤•à¥‡ à¤•à¥‡à¤‚à¤¦à¥à¤° à¤®à¥‡à¤‚à¥¤',
      default: 'ðŸ¤– à¤®à¥à¤à¥‡ à¤‡à¤¸ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚ à¤ªà¤•à¥à¤•à¤¾ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆ, à¤ªà¤° à¤®à¥ˆà¤‚ à¤«à¤¸à¤², à¤¸à¤¿à¤‚à¤šà¤¾à¤ˆ à¤¯à¤¾ à¤‰à¤°à¥à¤µà¤°à¤• à¤•à¥€ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤¦à¥‡ à¤¸à¤•à¤¤à¤¾ à¤¹à¥‚à¤!',
      hello: 'à¤¨à¤®à¤¸à¥à¤¤à¥‡! à¤®à¥ˆà¤‚ à¤†à¤ªà¤•à¥€ à¤•à¥ˆà¤¸à¥‡ à¤®à¤¦à¤¦ à¤•à¤° à¤¸à¤•à¤¤à¤¾ à¤¹à¥‚à¤? ðŸ˜Š',
      placeholder: 'à¤…à¤ªà¤¨à¤¾ à¤¸à¤‚à¤¦à¥‡à¤¶ à¤²à¤¿à¤–à¥‡à¤‚...',
      send: 'à¤­à¥‡à¤œà¥‡à¤‚',
      assistantName: 'à¤•à¤¿à¤¸à¤¾à¤¨ à¤¸à¤¾à¤¥à¥€ à¤¸à¤¹à¤¾à¤¯à¤•',
    },
    mr: {
      greeting: 'ðŸ‘‹ à¤¨à¤®à¤¸à¥à¤•à¤¾à¤°! à¤®à¥€ à¤¤à¥à¤®à¤šà¤¾ à¤•à¤¿à¤¸à¤¾à¤¨ à¤¸à¤¾à¤¥à¥€ à¤¸à¤¹à¤¾à¤¯à¥à¤¯à¤• à¤†à¤¹à¥‡.',
      help: 'à¤¤à¥à¤®à¥à¤¹à¥€ à¤®à¤²à¤¾ à¤ªà¤¿à¤• à¤¯à¥‹à¤œà¤¨à¤¾, à¤¸à¤¿à¤‚à¤šà¤¨, à¤°à¥‹à¤— à¤¨à¤¿à¤¯à¤‚à¤¤à¥à¤°à¤£, à¤–à¤¤ à¤µ à¤‡à¤¤à¤° à¤—à¥‹à¤·à¥à¤Ÿà¥€à¤‚à¤¬à¤¦à¥à¤¦à¤² à¤µà¤¿à¤šà¤¾à¤°à¥‚ à¤¶à¤•à¤¤à¤¾!',
      crop: 'ðŸŒ¾ à¤¤à¥à¤®à¤šà¥à¤¯à¤¾ à¤ªà¥à¤°à¤¦à¥‡à¤¶à¤¾à¤¸à¤¾à¤ à¥€ à¤¯à¤¾ à¤¹à¤‚à¤—à¤¾à¤®à¤¾à¤¤ à¤—à¤¹à¥‚ à¤†à¤£à¤¿ à¤®à¥‹à¤¹à¤°à¥€ à¤‰à¤¤à¥à¤¤à¤® à¤ªà¤°à¥à¤¯à¤¾à¤¯ à¤†à¤¹à¥‡à¤¤!',
      irrigation: 'ðŸ’§ à¤—à¤µà¥à¤¹à¤¾à¤¸à¤¾à¤ à¥€ 4 à¤¸à¤¿à¤‚à¤šà¤¨ à¤šà¤•à¥à¤° à¤•à¤°à¤¾ â€“ à¤Ÿà¤¿à¤²à¤°à¤¿à¤‚à¤—, à¤œà¥‰à¤‡à¤¨à¥à¤Ÿà¤¿à¤‚à¤—, à¤«à¥à¤²à¥‹à¤°à¤¾ à¤†à¤£à¤¿ à¤¡à¥‹à¤¹ à¤Ÿà¤ªà¥à¤ªà¥à¤¯à¤¾à¤¤.',
      disease: 'ðŸ¦  à¤¸à¤‚à¤­à¤¾à¤µà¥à¤¯ à¤°à¥‹à¤—: à¤²à¥€à¤« à¤°à¤¸à¥à¤Ÿ. à¤‰à¤ªà¤¾à¤¯: à¤®à¥…à¤¨à¥à¤•à¥‹à¤à¥‡à¤¬ (0.25%) à¤«à¤µà¤¾à¤°à¤£à¥€ à¤¦à¤° 10 à¤¦à¤¿à¤µà¤¸à¤¾à¤‚à¤¨à¥€ à¤•à¤°à¤¾.',
      fertilizer: 'ðŸŒ¿ à¤¶à¤¿à¤«à¤¾à¤°à¤¸ à¤•à¥‡à¤²à¥‡à¤²à¥‡ à¤–à¤¤: à¤¯à¥à¤°à¤¿à¤¯à¤¾ (120kg/ha) + DAP (60kg/ha) à¤¤à¥€à¤¨ à¤­à¤¾à¤—à¤¾à¤‚à¤¤ à¤¦à¥à¤¯à¤¾.',
      community: 'ðŸ‘¥ à¤¬à¤¾à¤œà¤¾à¤° à¤…à¤¦à¥à¤¯à¤¤à¤¨ à¤†à¤£à¤¿ à¤ªà¥à¤°à¤¶à¤¿à¤•à¥à¤·à¤£à¤¾à¤¸à¤¾à¤ à¥€ à¤œà¤µà¤³à¤šà¥à¤¯à¤¾ à¤¶à¥‡à¤¤à¤•à¤°à¥€ à¤¸à¤®à¥à¤¦à¤¾à¤¯ à¤¸à¤®à¥‚à¤¹à¤¾à¤¤ à¤¸à¤¾à¤®à¥€à¤² à¤µà¥à¤¹à¤¾.',
      training: 'ðŸ“˜ à¤†à¤—à¤¾à¤®à¥€ à¤ªà¥à¤°à¤¶à¤¿à¤•à¥à¤·à¤£: "à¤ªà¥à¤°à¤—à¤¤ à¤¸à¥‡à¤‚à¤¦à¥à¤°à¤¿à¤¯ à¤¶à¥‡à¤¤à¥€" 5 à¤¨à¥‹à¤µà¥à¤¹à¥‡à¤‚à¤¬à¤° à¤°à¥‹à¤œà¥€ à¤¤à¥à¤®à¤šà¥à¤¯à¤¾ à¤œà¤µà¤³à¤šà¥à¤¯à¤¾ KVK à¤•à¥‡à¤‚à¤¦à¥à¤°à¤¾à¤¤.',
      default: 'ðŸ¤– à¤®à¤²à¤¾ à¤–à¤¾à¤¤à¥à¤°à¥€ à¤¨à¤¾à¤¹à¥€, à¤ªà¤£ à¤®à¥€ à¤ªà¤¿à¤•, à¤¸à¤¿à¤‚à¤šà¤¨, à¤–à¤¤ à¤•à¤¿à¤‚à¤µà¤¾ à¤°à¥‹à¤— à¤®à¤¾à¤¹à¤¿à¤¤à¥€ à¤¦à¥‡à¤Š à¤¶à¤•à¤¤à¥‹!',
      hello: 'à¤¨à¤®à¤¸à¥à¤•à¤¾à¤°! à¤®à¥€ à¤¤à¥à¤®à¥à¤¹à¤¾à¤²à¤¾ à¤•à¤¶à¤¾à¤¤ à¤®à¤¦à¤¤ à¤•à¤°à¥‚ à¤¶à¤•à¤¤à¥‹? ðŸ˜Š',
      placeholder: 'à¤¤à¥à¤®à¤šà¤¾ à¤¸à¤‚à¤¦à¥‡à¤¶ à¤Ÿà¤¾à¤‡à¤ª à¤•à¤°à¤¾...',
      send: 'à¤ªà¤¾à¤ à¤µà¤¾',
      assistantName: 'à¤•à¤¿à¤¸à¤¾à¤¨ à¤¸à¤¾à¤¥à¥€ à¤¸à¤¹à¤¾à¤¯à¥à¤¯à¤•',
    },
    pa: {
      greeting: 'ðŸ‘‹ à¨¸à¨¤ à¨¸à©à¨°à©€ à¨…à¨•à¨¾à¨²! à¨®à©ˆà¨‚ à¨¤à©à¨¹à¨¾à¨¡à¨¾ à¨•à¨¿à¨¸à¨¾à¨¨ à¨¸à¨¾à¨¥à©€ à¨¸à¨¹à¨¾à¨‡à¨• à¨¹à¨¾à¨‚à¥¤',
      help: 'à¨¤à©à¨¸à©€à¨‚ à¨®à©ˆà¨¨à©‚à©° à¨«à¨¸à¨² à¨¯à©‹à¨œà¨¨à¨¾à¨µà¨¾à¨‚, à¨¸à¨¿à©°à¨šà¨¾à¨ˆ, à¨¬à¨¿à¨®à¨¾à¨°à©€ à¨¨à¨¿à¨¯à©°à¨¤à¨°à¨£, à¨–à¨¾à¨¦à¨¾à¨‚ à¨…à¨¤à©‡ à¨¹à©‹à¨° à¨¬à¨¹à©à¨¤ à¨•à©à¨ à¨¬à¨¾à¨°à©‡ à¨ªà©à©±à¨› à¨¸à¨•à¨¦à©‡ à¨¹à©‹!',
      crop: 'ðŸŒ¾ à¨¤à©à¨¹à¨¾à¨¡à©‡ à¨–à©‡à¨¤à¨° à¨¦à©‡ à¨…à¨¨à©à¨¸à¨¾à¨°, à¨‡à¨¸ à¨®à©Œà¨¸à¨® à¨²à¨ˆ à¨•à¨£à¨• à¨…à¨¤à©‡ à¨¸à¨°à©à¨¹à©‹à¨‚ à¨µà¨§à©€à¨† à¨µà¨¿à¨•à¨²à¨ª à¨¹à¨¨!',
      irrigation: 'ðŸ’§ à¨•à¨£à¨• à¨²à¨ˆ, 4 à¨¸à¨¿à©°à¨šà¨¾à¨ˆ à¨šà©±à¨•à¨°à¨¾à¨‚ à¨¦à©€ à¨ªà¨¾à¨²à¨£à¨¾ à¨•à¨°à©‹ - à¨Ÿà¨¿à¨²à¨°à¨¿à©°à¨—, à¨œà©à¨†à¨‡à©°à¨Ÿà¨¿à©°à¨—, à¨«à©à©±à¨² à¨†à¨‰à¨£ à¨…à¨¤à©‡ à¨¦à¨¾à¨£à©‡ à¨¬à¨£à¨¨ à¨¦à©‡ à¨ªà©œà¨¾à¨µà¨¾à¨‚ à¨¤à©‡à¥¤',
      disease: 'ðŸ¦  à¨¸à©°à¨­à¨¾à¨µà¨¿à¨¤ à¨¬à¨¿à¨®à¨¾à¨°à©€: à¨ªà©±à¨¤à¨¿à¨†à¨‚ à¨¦à©€ à¨•à©à©°à¨—à©€à¥¤ à¨‡à¨²à¨¾à¨œ: à¨®à©ˆà¨¨à¨•à©‹à¨œà¨¼à©‡à¨¬ (0.25%) à¨¦à¨¾ à¨›à¨¿à©œà¨•à¨¾à¨… à¨¹à¨° 10 à¨¦à¨¿à¨¨à¨¾à¨‚ à¨¬à¨¾à¨…à¨¦ à¨•à¨°à©‹à¥¤',
      fertilizer: 'ðŸŒ¿ à¨¸à¨¿à¨«à¨¼à¨¾à¨°à¨¸à¨¼à©€ à¨–à¨¾à¨¦: à¨¯à©‚à¨°à©€à¨† (120kg/ha) + DAP (60kg/ha) 3 à¨–à©à¨°à¨¾à¨•à¨¾à¨‚ à¨µà¨¿à©±à¨š à¨µà©°à¨¡ à¨•à©‡ à¨¦à¨¿à¨“à¥¤',
      community: 'ðŸ‘¥ à¨¤à©à¨¸à©€à¨‚ à¨®à¨¾à¨°à¨•à©€à¨Ÿ à¨…à¨ªà¨¡à©‡à¨Ÿà¨¾à¨‚ à¨…à¨¤à©‡ à¨¸à¨¿à¨–à¨²à¨¾à¨ˆ à¨¸à©ˆà¨¸à¨¼à¨¨à¨¾à¨‚ à¨²à¨ˆ à¨†à¨ªà¨£à©‡ à¨¨à©‡à©œà¨²à©‡ à¨•à¨¿à¨¸à¨¾à¨¨ à¨­à¨¾à¨ˆà¨šà¨¾à¨°à©‡ à¨¸à¨®à©‚à¨¹ à¨µà¨¿à©±à¨š à¨¸à¨¼à¨¾à¨®à¨² à¨¹à©‹ à¨¸à¨•à¨¦à©‡ à¨¹à©‹à¥¤',
      training: 'ðŸ“˜ à¨†à¨—à¨¾à¨®à©€ à¨¸à¨¿à¨–à¨²à¨¾à¨ˆ: "à¨‰à©±à¨¨à¨¤ à¨œà©ˆà¨µà¨¿à¨• à¨–à©‡à¨¤à©€" 5 à¨¨à¨µà©°à¨¬à¨° à¨¨à©‚à©° à¨¤à©à¨¹à¨¾à¨¡à©‡ à¨¨à¨œà¨¼à¨¦à©€à¨•à©€ KVK à¨•à©‡à¨‚à¨¦à¨° à¨µà¨¿à¨–à©‡à¥¤',
      default: 'ðŸ¤– à¨®à©ˆà¨¨à©‚à©° à¨‡à¨¸ à¨¬à¨¾à¨°à©‡ à¨¯à¨•à©€à¨¨ à¨¨à¨¹à©€à¨‚ à¨¹à©ˆ, à¨ªà¨° à¨®à©ˆà¨‚ à¨«à¨¸à¨²à¨¾à¨‚, à¨¸à¨¿à©°à¨šà¨¾à¨ˆ, à¨–à¨¾à¨¦ à¨œà¨¾à¨‚ à¨¬à¨¿à¨®à¨¾à¨°à©€ à¨¬à¨¾à¨°à©‡ à¨œà¨¾à¨£à¨•à¨¾à¨°à©€ à¨¦à©‡ à¨¸à¨•à¨¦à¨¾ à¨¹à¨¾à¨‚!',
      hello: 'à¨¸à¨¤ à¨¸à©à¨°à©€ à¨…à¨•à¨¾à¨²! à¨…à©±à¨œ à¨®à©ˆà¨‚ à¨¤à©à¨¹à¨¾à¨¡à©€ à¨•à¨¿à¨µà©‡à¨‚ à¨®à¨¦à¨¦ à¨•à¨° à¨¸à¨•à¨¦à¨¾ à¨¹à¨¾à¨‚? ðŸ˜Š',
      placeholder: 'à¨†à¨ªà¨£à¨¾ à¨¸à©à¨¨à©‡à¨¹à¨¾ à¨Ÿà¨¾à¨ˆà¨ª à¨•à¨°à©‹...',
      send: 'à¨­à©‡à¨œà©‹',
      assistantName: 'à¨•à¨¿à¨¸à¨¾à¨¨ à¨¸à¨¾à¨¥à©€ à¨¸à¨¹à¨¾à¨‡à¨•',
    },
    bn: {
      greeting: 'ðŸ‘‹ à¦¨à¦®à¦¸à§à¦•à¦¾à¦°! à¦†à¦®à¦¿ à¦†à¦ªà¦¨à¦¾à¦° à¦•à¦¿à¦¸à¦¾à¦¨ à¦¸à¦¾à¦¥à§€ à¦¸à¦¹à¦•à¦¾à¦°à§€à¥¤',
      help: 'à¦†à¦ªà¦¨à¦¿ à¦†à¦®à¦¾à¦•à§‡ à¦«à¦¸à¦² à¦ªà¦°à¦¿à¦•à¦²à§à¦ªà¦¨à¦¾, à¦¸à§‡à¦š, à¦°à§‹à¦— à¦¨à¦¿à¦¯à¦¼à¦¨à§à¦¤à§à¦°à¦£, à¦¸à¦¾à¦° à¦à¦¬à¦‚ à¦†à¦°à¦“ à¦…à¦¨à§‡à¦• à¦•à¦¿à¦›à§ à¦¸à¦®à§à¦ªà¦°à§à¦•à§‡ à¦œà¦¿à¦œà§à¦žà¦¾à¦¸à¦¾ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¨!',
      crop: 'ðŸŒ¾ à¦†à¦ªà¦¨à¦¾à¦° à¦…à¦žà§à¦šà¦²à§‡à¦° à¦‰à¦ªà¦° à¦­à¦¿à¦¤à§à¦¤à¦¿ à¦•à¦°à§‡, à¦à¦‡ à¦®à§Œà¦¸à§à¦®à§‡à¦° à¦œà¦¨à§à¦¯ à¦—à¦® à¦à¦¬à¦‚ à¦¸à¦°à¦¿à¦·à¦¾ à¦¦à§à¦°à§à¦¦à¦¾à¦¨à§à¦¤ à¦¬à¦¿à¦•à¦²à§à¦ª!',
      irrigation: 'ðŸ’§ à¦—à¦®à§‡à¦° à¦œà¦¨à§à¦¯, à¦Ÿà¦¿à¦²à¦¾à¦°à¦¿à¦‚, à¦œà¦¯à¦¼à§‡à¦¨à§à¦Ÿà¦¿à¦‚, à¦«à§à¦² à¦«à§‹à¦Ÿà¦¾ à¦à¦¬à¦‚ à¦¦à¦¾à¦¨à¦¾ à¦—à¦ à¦¨à§‡à¦° à¦ªà¦°à§à¦¯à¦¾à¦¯à¦¼à§‡ à§ªà¦Ÿà¦¿ à¦¸à§‡à¦š à¦šà¦•à§à¦° à¦…à¦¨à§à¦¸à¦°à¦£ à¦•à¦°à§à¦¨à¥¤',
      disease: 'ðŸ¦  à¦¸à¦®à§à¦­à¦¾à¦¬à§à¦¯ à¦°à§‹à¦—: à¦ªà¦¾à¦¤à¦¾à¦° à¦®à¦°à¦¿à¦šà¦¾à¥¤ à¦ªà§à¦°à¦¤à¦¿à¦•à¦¾à¦°: à¦®à§à¦¯à¦¾à¦¨à¦•à§‹à¦œà§‡à¦¬ à¦¸à§à¦ªà§à¦°à§‡ (0.25%) à¦ªà§à¦°à¦¤à¦¿ à§§à§¦ à¦¦à¦¿à¦¨ à¦…à¦¨à§à¦¤à¦° à¦•à¦°à§à¦¨à¥¤',
      fertilizer: 'ðŸŒ¿ à¦ªà§à¦°à¦¸à§à¦¤à¦¾à¦¬à¦¿à¦¤ à¦¸à¦¾à¦°: à¦‡à¦‰à¦°à¦¿à¦¯à¦¼à¦¾ (120 à¦•à§‡à¦œà¦¿/à¦¹à§‡à¦•à§à¦Ÿà¦°) + à¦¡à¦¿à¦à¦ªà¦¿ (60 à¦•à§‡à¦œà¦¿/à¦¹à§‡à¦•à§à¦Ÿà¦°) à§©à¦Ÿà¦¿ à¦¡à§‹à¦œà§‡ à¦¬à¦¿à¦­à¦•à§à¦¤à¥¤',
      community: 'ðŸ‘¥ à¦†à¦ªà¦¨à¦¿ à¦¬à¦¾à¦œà¦¾à¦°à§‡à¦° à¦†à¦ªà¦¡à§‡à¦Ÿ à¦à¦¬à¦‚ à¦ªà§à¦°à¦¶à¦¿à¦•à§à¦·à¦£ à¦¸à§‡à¦¶à¦¨à§‡à¦° à¦œà¦¨à§à¦¯ à¦†à¦ªà¦¨à¦¾à¦° à¦¨à¦¿à¦•à¦Ÿà¦¬à¦°à§à¦¤à§€ à¦•à§ƒà¦·à¦• à¦¸à¦®à§à¦ªà§à¦°à¦¦à¦¾à¦¯à¦¼à§‡à¦° à¦—à§à¦°à§à¦ªà§‡ à¦¯à§‹à¦— à¦¦à¦¿à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¨à¥¤',
      training: 'ðŸ“˜ à¦†à¦¸à¦¨à§à¦¨ à¦ªà§à¦°à¦¶à¦¿à¦•à§à¦·à¦£: "à¦‰à¦¨à§à¦¨à¦¤ à¦œà§ˆà¦¬ à¦šà¦¾à¦·" à§«à¦‡ à¦¨à¦­à§‡à¦®à§à¦¬à¦° à¦†à¦ªà¦¨à¦¾à¦° à¦¨à¦¿à¦•à¦Ÿà¦¤à¦® KVK à¦•à§‡à¦¨à§à¦¦à§à¦°à§‡à¥¤',
      default: 'ðŸ¤– à¦†à¦®à¦¿ à¦ à¦¬à§à¦¯à¦¾à¦ªà¦¾à¦°à§‡ à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦¨à¦‡, à¦¤à¦¬à§‡ à¦†à¦®à¦¿ à¦«à¦¸à¦², à¦¸à§‡à¦š, à¦¸à¦¾à¦° à¦¬à¦¾ à¦°à§‹à¦—à§‡à¦° à¦¤à¦¥à§à¦¯ à¦¦à¦¿à¦¯à¦¼à§‡ à¦¸à¦¾à¦¹à¦¾à¦¯à§à¦¯ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿!',
      hello: 'à¦¨à¦®à¦¸à§à¦•à¦¾à¦°! à¦†à¦®à¦¿ à¦†à¦œ à¦†à¦ªà¦¨à¦¾à¦•à§‡ à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦¸à¦¾à¦¹à¦¾à¦¯à§à¦¯ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿? ðŸ˜Š',
      placeholder: 'à¦†à¦ªà¦¨à¦¾à¦° à¦¬à¦¾à¦°à§à¦¤à¦¾ à¦Ÿà¦¾à¦‡à¦ª à¦•à¦°à§à¦¨...',
      send: 'à¦ªà¦¾à¦ à¦¾à¦¨',
      assistantName: 'à¦•à¦¿à¦¸à¦¾à¦¨ à¦¸à¦¾à¦¥à§€ à¦¸à¦¹à¦•à¦¾à¦°à§€',
    },
    ta: {
      greeting: 'ðŸ‘‹ à®µà®£à®•à¯à®•à®®à¯! à®¨à®¾à®©à¯ à®‰à®™à¯à®•à®³à¯ à®•à®¿à®šà®¾à®©à¯ à®šà®¾à®¤à¯à®¤à®¿ à®‰à®¤à®µà®¿à®¯à®¾à®³à®°à¯.',
      help: 'à®ªà®¯à®¿à®°à¯ à®¤à®¿à®Ÿà¯à®Ÿà®™à¯à®•à®³à¯, à®¨à¯€à®°à¯à®ªà¯à®ªà®¾à®šà®©à®®à¯, à®¨à¯‹à®¯à¯ à®•à®Ÿà¯à®Ÿà¯à®ªà¯à®ªà®¾à®Ÿà¯, à®‰à®°à®™à¯à®•à®³à¯ à®®à®±à¯à®±à¯à®®à¯ à®ªà®²à®µà®±à¯à®±à¯ˆà®ªà¯ à®ªà®±à¯à®±à®¿ à®¨à¯€à®™à¯à®•à®³à¯ à®Žà®©à¯à®©à®¿à®Ÿà®®à¯ à®•à¯‡à®Ÿà¯à®•à®²à®¾à®®à¯!',
      crop: 'ðŸŒ¾ à®‰à®™à¯à®•à®³à¯ à®ªà®•à¯à®¤à®¿à®¯à®¿à®©à¯ à®…à®Ÿà®¿à®ªà¯à®ªà®Ÿà¯ˆà®¯à®¿à®²à¯, à®‡à®¨à¯à®¤ à®ªà®°à¯à®µà®¤à¯à®¤à®¿à®±à¯à®•à¯ à®•à¯‹à®¤à¯à®®à¯ˆ à®®à®±à¯à®±à¯à®®à¯ à®•à®Ÿà¯à®•à¯ à®šà®¿à®±à®¨à¯à®¤ à®µà®¿à®°à¯à®ªà¯à®ªà®™à¯à®•à®³à¯!',
      irrigation: 'ðŸ’§ à®•à¯‹à®¤à¯à®®à¯ˆà®•à¯à®•à¯, à®¤à¯‚à®°à¯à®µà®¿à®Ÿà¯à®®à¯, à®•à®£à¯à®µà®¿à®Ÿà¯à®®à¯, à®ªà¯‚à®•à¯à®•à¯à®®à¯ à®®à®±à¯à®±à¯à®®à¯ à®ªà®¾à®²à¯ à®ªà®¿à®Ÿà®¿à®•à¯à®•à¯à®®à¯ à®¨à®¿à®²à¯ˆà®•à®³à®¿à®²à¯ 4 à®¨à¯€à®°à¯à®ªà¯à®ªà®¾à®šà®© à®šà¯à®´à®±à¯à®šà®¿à®•à®³à¯ˆà®ªà¯ à®ªà®¿à®©à¯à®ªà®±à¯à®±à®µà¯à®®à¯.',
      disease: 'ðŸ¦  à®šà®¾à®¤à¯à®¤à®¿à®¯à®®à®¾à®© à®¨à¯‹à®¯à¯: à®‡à®²à¯ˆà®¤à¯ à®¤à¯à®°à¯. à¦ªà§à¦°à¦¤à¦¿à¦•à®¾à®°à®®à¯: à®®à®¾à®©à¯à®•à¯‹à®šà¯†à®ªà¯ à®¤à¯†à®³à®¿à®ªà¯à®ªà¯ (0.25%) à®’à®µà¯à®µà¯Šà®°à¯ 10 à®¨à®¾à®Ÿà¯à®•à®³à¯à®•à¯à®•à¯à®®à¯ à®’à®°à¯à®®à¯à®±à¯ˆ.',
      fertilizer: 'ðŸŒ¿ à®ªà®°à®¿à®¨à¯à®¤à¯à®°à¯ˆà®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®®à¯ à®‰à®°à®®à¯: à®¯à¯‚à®°à®¿à®¯à®¾ (120 à®•à®¿à®²à¯‹/à®¹à¯†à®•à¯à®Ÿà¯‡à®°à¯) + à®Ÿà®¿à®à®ªà®¿ (60 à®•à®¿à®²à¯‹/à®¹à¯†à®•à¯à®Ÿà¯‡à®°à¯) 3 à®…à®³à®µà¯à®•à®³à®¿à®²à¯ à®ªà®¿à®°à®¿à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯.',
      community: 'ðŸ‘¥ à®šà®¨à¯à®¤à¯ˆ à®¨à®¿à®²à®µà®°à®™à¯à®•à®³à¯ à®®à®±à¯à®±à¯à®®à¯ à®ªà®¯à®¿à®±à¯à®šà®¿ à®…à®®à®°à¯à®µà¯à®•à®³à¯à®•à¯à®•à¯ à®‰à®™à¯à®•à®³à¯ à®…à®°à¯à®•à®¿à®²à¯à®³à¯à®³ à®‰à®´à®µà®°à¯ à®šà®®à¯‚à®•à®•à¯ à®•à¯à®´à¯à®µà®¿à®²à¯ à®šà¯‡à®°à®²à®¾à®®à¯.',
      training: 'ðŸ“˜ à®µà®°à®µà®¿à®°à¯à®•à¯à®•à¯à®®à¯ à®ªà®¯à®¿à®±à¯à®šà®¿: "à®®à¯‡à®®à¯à®ªà®Ÿà¯à®Ÿ à®•à®°à®¿à®® à®µà¯‡à®³à®¾à®£à¯à®®à¯ˆ" à®¨à®µà®®à¯à®ªà®°à¯ 5 à®†à®®à¯ à®¤à¯‡à®¤à®¿ à®‰à®™à¯à®•à®³à¯ à®…à®°à¯à®•à®¿à®²à¯à®³à¯à®³ KVK à®®à¯ˆà®¯à®¤à¯à®¤à®¿à®²à¯.',
      default: 'ðŸ¤– à®…à®¤à¯ˆà®ªà¯ à®ªà®±à¯à®±à®¿ à®Žà®©à®•à¯à®•à¯ à®‰à®±à¯à®¤à®¿à®¯à®¾à®•à®¤à¯ à®¤à¯†à®°à®¿à®¯à®µà®¿à®²à¯à®²à¯ˆ, à®†à®©à®¾à®²à¯ à®ªà®¯à®¿à®°à¯à®•à®³à¯, à®¨à¯€à®°à¯à®ªà¯à®ªà®¾à®šà®©à®®à¯, à®‰à®°à®®à¯ à®…à®²à¯à®²à®¤à¯ à®¨à¯‹à®¯à¯ à®ªà®±à¯à®±à®¿à®¯ à®¤à®•à®µà®²à¯à®•à®³à¯à®•à¯à®•à¯ à®¨à®¾à®©à¯ à®‰à®¤à®µ à®®à¯à®Ÿà®¿à®¯à¯à®®à¯!',
      hello: 'à®µà®£à®•à¯à®•à®®à¯! à®‡à®©à¯à®±à¯ à®¨à®¾à®©à¯ à®‰à®™à¯à®•à®³à¯à®•à¯à®•à¯ à®Žà®ªà¯à®ªà®Ÿà®¿ à®‰à®¤à®µ à®®à¯à®Ÿà®¿à®¯à¯à®®à¯? ðŸ˜Š',
      placeholder: 'à®‰à®™à¯à®•à®³à¯ à®šà¯†à®¯à¯à®¤à®¿à®¯à¯ˆ à®¤à®Ÿà¯à®Ÿà®šà¯à®šà¯ à®šà¯†à®¯à¯à®¯à®µà¯à®®à¯...',
      send: 'à®…à®©à¯à®ªà¯à®ªà¯',
      assistantName: 'à®•à®¿à®šà®¾à®©à¯ à®šà®¾à®¤à¯à®¤à®¿ à®‰à®¤à®µà®¿à®¯à®¾à®³à®°à¯',
    },
  };

  const initialMessages = [
    { sender: 'bot', text: translations[language].greeting },
    { sender: 'bot', text: translations[language].help },
  ];

  // --- Mock Reply Logic ---
  const getMockReply = (query: string) => {
    const q = query.toLowerCase();
    const t = translations[language];
    if (q.includes('crop') || q.includes('plan')) return t.crop;
    if (q.includes('irrigation') || q.includes('à¤¸à¤¿à¤‚à¤šà¤¾à¤ˆ')) return t.irrigation;
    if (q.includes('disease') || q.includes('à¤°à¥‹à¤—')) return t.disease;
    if (q.includes('fertilizer') || q.includes('fertiliser') || q.includes('à¤‰à¤°à¥à¤µà¤°à¤•')) return t.fertilizer;
    if (q.includes('community') || q.includes('à¤¸à¤®à¥à¤¦à¤¾à¤¯')) return t.community;
    if (q.includes('training') || q.includes('à¤ªà¥à¤°à¤¶à¤¿à¤•à¥à¤·à¤£')) return t.training;
    if (q.includes('hello') || q.includes('hi') || q.includes('à¤¨à¤®à¤¸à¥à¤¤à¥‡') || q.includes('à¤¨à¤®à¤¸à¥à¤•à¤¾à¤°')) return t.hello;
    return t.default;
  };

  const handleSend = () => {
    if (!input.trim()) return;

    const userMsg = { sender: 'user', text: input.trim() };
    const currentMessages = messages.length > 0 ? messages : initialMessages;
    setMessages([...currentMessages, userMsg]);

    setTimeout(() => {
      const botReply = getMockReply(input.trim());
      setMessages((prev) => [...prev, { sender: 'bot', text: botReply }]);
    }, 600);

    setInput('');
  };

  const handleLanguageChange = () => {
    const languages: Language[] = ['en', 'hi', 'mr', 'pa', 'bn', 'ta'];
    const currentIndex = languages.indexOf(language);
    const nextIndex = (currentIndex + 1) % languages.length;
    setLanguage(languages[nextIndex]);
  };

  return (
    <div className="relative flex flex-col min-h-screen">
      <DashboardNavbar />
      <main className="grow">
        <Outlet />
      </main>
      <DashboardFooter />

      {/* Floating Chat Button + Window */}
      <div className="fixed bottom-6 right-6 z-50">
        {!isChatOpen && (
          <button
            onClick={() => setIsChatOpen(true)}
            className="bg-green-600 hover:bg-green-700 text-white rounded-full p-4 shadow-lg transition-all"
          >
            <MessageCircle className="h-6 w-6" />
          </button>
        )}

        {isChatOpen && (
          <div className="w-[420px] h-[520px] bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden flex flex-col animate-fadeIn">
            {/* Header */}
            <div className="flex items-center justify-between bg-green-600 text-white p-3">
              <h2 className="text-lg font-semibold">{translations[language].assistantName}</h2>
              <div className="flex gap-2">
                <button
                  onClick={handleLanguageChange}
                  className="bg-white text-green-700 p-1.5 rounded-lg hover:bg-green-50"
                  title="Change Language"
                >
                  <Globe className="h-5 w-5" />
                </button>
                <button onClick={() => setIsChatOpen(false)}>
                  <X className="h-5 w-5" />
                </button>
              </div>
            </div>

            {/* Chat Body */}
            <div className="flex-1 p-4 overflow-y-auto space-y-3 text-sm">
              {(messages.length > 0 ? messages : initialMessages).map((msg, i) => (
                <div
                  key={i}
                  className={`flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}
                >
                  <div
                    className={`px-3 py-2 rounded-lg max-w-[75%] ${
                      msg.sender === 'user'
                        ? 'bg-green-600 text-white rounded-br-none'
                        : 'bg-gray-100 text-gray-800 rounded-bl-none'
                    }`}
                  >
                    {msg.text}
                  </div>
                </div>
              ))}
            </div>

            {/* Input Area */}
            <div className="p-3 border-t flex items-center">
              <input
                type="text"
                value={input}
                onChange={(e) => setInput(e.target.value)}
                placeholder={translations[language].placeholder}
                className="flex-1 border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-400"
                onKeyDown={(e) => e.key === 'Enter' && handleSend()}
              />
              <button
                onClick={handleSend}
                className="ml-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm"
              >
                {translations[language].send}
              </button>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}